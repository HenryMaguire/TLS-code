(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     52009,       1376]
NotebookOptionsPosition[     51271,       1347]
NotebookOutlinePosition[     51631,       1363]
CellTagsIndexPosition[     51588,       1360]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Basic", " ", 
    RowBox[{"code", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"logspace", "[", 
      RowBox[{"a_", ",", "b_", ",", "n_"}], "]"}], ":=", 
     RowBox[{"10.", "^", 
      RowBox[{"Range", "[", 
       RowBox[{"a", ",", "b", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"b", "-", "a"}], ")"}], "/", "n"}]}], "]"}]}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"linspace", "[", 
      RowBox[{"a_", ",", "b_", ",", "n_"}], "]"}], ":=", 
     RowBox[{"Range", "[", 
      RowBox[{"a", ",", "b", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "-", "a"}], ")"}], "/", "n"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"tensor", "[", "a___", "]"}], ":=", 
    RowBox[{"KroneckerProduct", "[", "a", "]"}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"out", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{"Outer", "[", 
     RowBox[{"Times", ",", "a", ",", 
      RowBox[{"Conjugate", "@", "b"}]}], "]"}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"destroy", "[", "n_", "]"}], ":=", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Sqrt", "[", "#1", "]"}], 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"#1", ",", 
          RowBox[{"#2", "-", "1"}]}], "]"}]}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"create", "[", "n_", "]"}], ":=", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Sqrt", "[", "#2", "]"}], 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"#1", ",", 
          RowBox[{"#2", "+", "1"}]}], "]"}]}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qeye", "[", "n_", "]"}], ":=", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dag", "[", "a_", "]"}], ":=", 
    RowBox[{"ConjugateTranspose", "[", "a", "]"}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"a", ".", "b"}], "-", 
     RowBox[{"b", ".", "a"}]}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ac", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"a", ".", "b"}], "+", 
     RowBox[{"b", ".", "a"}]}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L", "[", 
     RowBox[{"a_", ",", "rho_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"a", ".", "rho", ".", 
       RowBox[{"dag", "[", "a", "]"}]}]}], "-", 
     RowBox[{"ac", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dag", "[", "a", "]"}], ".", "a"}], ",", "rho"}], "]"}]}]}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rho", "[", "n_", "]"}], ":=", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"r", ",", "#1", ",", "#2"}], "]"}], "[", "t", "]"}], "&"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Lamb", "[", 
     RowBox[{"n_", ",", "t_", ",", "tau_"}], "]"}], ":=", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"La", ",", "#1", ",", "#2"}], "]"}], "[", 
        RowBox[{"t", ",", "tau"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LambSpec", "[", 
     RowBox[{"n_", ",", "tau_"}], "]"}], ":=", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"La", ",", "#1", ",", "#2"}], "]"}], "[", "tau", "]"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"MatFromVec", "[", "vec_", "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dim", "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"Length", "[", "vec", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Take", "[", 
         RowBox[{"vec", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "*", "dim"}], "+", "1"}], ",", 
            RowBox[{"dim", "*", 
             RowBox[{"(", 
              RowBox[{"i", "+", "1"}], ")"}]}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"fockbasis", "[", 
     RowBox[{"dim_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{
          RowBox[{"n", "+", "1"}], ",", "#1"}], "]"}], "*", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"#2", ",", 
          RowBox[{"n", "+", "1"}]}], "]"}]}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{
    RowBox[{"Disp", "[", 
     RowBox[{"n_", ",", "alp_"}], "]"}], ":=", 
    RowBox[{"MatrixExp", "[", 
     RowBox[{"alp", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"create", "[", "n", "]"}], "-", 
        RowBox[{"destroy", "[", "n", "]"}]}], ")"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"MeqToLio", "[", "meq_", "]"}], ":=", 
    RowBox[{"Normal", "[", 
     RowBox[{
      RowBox[{"CoefficientArrays", "[", 
       RowBox[{
        RowBox[{"Flatten", "@", "meq"}], ",", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Rho", "[", 
          RowBox[{"Length", "@", "meq"}], "]"}]}]}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nocc", "[", 
     RowBox[{"nu_", ",", "beta_"}], "]"}], ":=", 
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"beta", "*", "nu"}], "]"}], "-", "1"}], ")"}]}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"print", "[", "x___", "]"}], ":=", 
    RowBox[{"Print", "[", "x", "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"ops", "[", "n_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sm", ",", " ", "sp", ",", " ", "a", ",", " ", "adag"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sm", " ", "=", " ", 
        RowBox[{"tensor", "[", 
         RowBox[{
          RowBox[{"destroy", "[", "2", "]"}], ",", 
          RowBox[{"qeye", "[", "n", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sp", " ", "=", " ", 
        RowBox[{"dag", "[", "sm", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"a", " ", "=", " ", 
        RowBox[{"tensor", "[", 
         RowBox[{
          RowBox[{"qeye", "[", "2", "]"}], ",", 
          RowBox[{"destroy", "[", "n", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"adag", " ", "=", " ", 
        RowBox[{"dag", "@", "a"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"N", "@", 
        RowBox[{"{", 
         RowBox[{"sm", ",", " ", "sp", ",", " ", "a", ",", " ", "adag"}], 
         "}"}]}]}]}], "]"}]}], "\n", "\n", " ", "\n", 
   RowBox[{
    RowBox[{"JUD", "[", 
     RowBox[{"w_", ",", " ", "alp_", ",", " ", "w0_", ",", " ", "Gam_"}], 
     "]"}], ":=", 
    FractionBox[
     RowBox[{"alp", " ", "\[Times]", " ", "Gam", " ", "\[Times]", " ", 
      SuperscriptBox["w0", "2"], "w"}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["w", "2"], "-", 
         SuperscriptBox["w0", "2"]}], ")"}], "2"], "+", 
      RowBox[{
       SuperscriptBox["Gam", "2"], 
       SuperscriptBox["w", "2"]}]}]]}], "\n", "\n", 
   RowBox[{
    RowBox[{"IBMintegrand", "[", 
     RowBox[{
     "t_", ",", "w_", ",", "alp_", ",", "w0_", ",", "Gam_", ",", " ", 
      "beta_"}], "]"}], ":=", " ", 
    RowBox[{
     FractionBox[
      RowBox[{"JUD", "[", 
       RowBox[{"w", ",", " ", "alp", ",", " ", "w0", ",", " ", "Gam"}], "]"}], 
      SuperscriptBox["w", "2"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Cos", "[", 
           RowBox[{"w", " ", "t"}], "]"}]}], ")"}], "\[Times]", 
        RowBox[{"Coth", "[", 
         FractionBox[
          RowBox[{"beta", " ", "w"}], "2"], "]"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"w", " ", "t"}], "]"}]}]}], ")"}]}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"Gfunc", "[", 
     RowBox[{
     "t_", ",", " ", "eps_", ",", " ", "alp_", ",", " ", "w0_", ",", " ", 
      "Gam_", ",", " ", "beta_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", "eps", " ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"-", " ", "1.5707963267948963`"}], " ", "alp"}], "*)"}], 
        ")"}], "t"}], "]"}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{"Evaluate", "@", 
          RowBox[{"IBMintegrand", "[", 
           RowBox[{
           "t", ",", " ", "w", ",", " ", "alp", ",", " ", "w0", ",", " ", 
            "Gam", ",", " ", "beta"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"w", ",", "0", ",", "\[Infinity]"}], "}"}], ",", "\n", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", 
            RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "False"}]}], 
           "}"}]}], ",", 
         RowBox[{"AccuracyGoal", "\[Rule]", "6"}], ",", 
         RowBox[{"MaxRecursion", "\[Rule]", "20"}]}], "]"}]}], "]"}]}]}], 
   "  ", "\n", "\n", "\n", "\n", 
   RowBox[{
    RowBox[{"RhoSolve", "[", 
     RowBox[{"lio_", ",", "inn_", ",", "tend_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dim", ",", "rho", ",", "meq", ",", "Rho0", ",", "sol"}], 
       "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"dim", "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"Length", "@", "lio"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rho", "=", 
        RowBox[{"Rho", "[", "dim", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"meq", "=", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"D", "[", 
            RowBox[{"rho", ",", "t"}], "]"}], "]"}], "\[Equal]", 
          RowBox[{"(", 
           RowBox[{"lio", ".", 
            RowBox[{"Flatten", "[", "rho", "]"}]}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Rho0", "=", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"rho", "/.", 
            RowBox[{"t", "\[Rule]", "0"}]}], "]"}], "\[Equal]", 
          RowBox[{"Flatten", "[", "inn", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sol", "=", 
        RowBox[{"AbsoluteTiming", "[", 
         RowBox[{"NDSolveValue", "[", 
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{"meq", ",", "Rho0"}], "}"}]}], ",", 
           RowBox[{"Diagonal", "@", "rho"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "tend"}], "}"}], ",", 
           RowBox[{"Method", "->", 
            RowBox[{"{", 
             RowBox[{
             "\"\<EquationSimplification\>\"", "->", "\"\<Solve\>\""}], 
             "}"}]}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"print", "[", 
        RowBox[{"\"\<Took me \>\"", ",", 
         RowBox[{
          RowBox[{"sol", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/", "60"}], ",", 
         "\"\< minutes to integrate the master equation.\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "sol", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
     "]"}]}], "\n", "\n", "\n", "\n", 
   RowBox[{
    RowBox[{"RhoVecSolve", "[", 
     RowBox[{"lio_", ",", "inn_", ",", "tend_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dim", ",", "rho", ",", "meq", ",", "Rho0", ",", "sol"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sol", "=", 
        RowBox[{"AbsoluteTiming", "[", 
         RowBox[{"NDSolveValue", "[", 
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"\[Rho]", "'"}], "[", "t", "]"}], " ", "\[Equal]", 
               " ", 
               RowBox[{"lio", ".", 
                RowBox[{"\[Rho]", "[", "t", "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", 
               RowBox[{"Flatten", "[", "inn", "]"}]}]}], "}"}]}], ",", 
           "\[Rho]", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "tend"}], "}"}], ",", 
           RowBox[{"AccuracyGoal", "\[Rule]", "8"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"print", "[", 
        RowBox[{"\"\<Took me \>\"", ",", 
         RowBox[{
          RowBox[{"sol", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/", "60"}], ",", 
         "\"\< minutes to integrate the master equation.\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "sol", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
     "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"RhoSteady", "[", "lio_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dim", ",", "rho", ",", " ", "meq", ",", " ", "steady"}], 
       "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"dim", "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"Length", "@", "lio"}], "]"}]}], ";", "\n", 
       RowBox[{"rho", "  ", "=", " ", 
        RowBox[{"Rho", "[", "dim", "]"}]}], ";", "\n", 
       RowBox[{"meq", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"0", "\[Equal]", 
            RowBox[{"(", 
             RowBox[{"lio", ".", 
              RowBox[{"Flatten", "[", "rho", "]"}]}], ")"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"Tr", "[", "rho", "]"}], "\[Equal]", "1"}]}], "]"}]}], ";",
        "\n", 
       RowBox[{"steady", " ", "=", " ", 
        RowBox[{"rho", "/.", 
         RowBox[{"First", "[", 
          RowBox[{"NSolve", "[", 
           RowBox[{"meq", ",", " ", 
            RowBox[{"Flatten", "@", "rho"}]}], "]"}], "]"}]}]}], ";", "\n", 
       "steady"}]}], "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.776514975484429*^9, 3.776514980697956*^9}},
 ExpressionUUID -> "f73d36e4-fb6c-4ad3-81fd-4271d3954aa2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"JEM", "[", 
    RowBox[{"w_", ",", " ", "eps_", ",", " ", "Gam0_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["Gam0", 
     RowBox[{"2", "\[Pi]", " ", 
      SuperscriptBox["eps", "3"]}]], 
    SuperscriptBox["w", "3"]}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"PhotDissInc", "[", 
   RowBox[{"Ham_", ",", " ", "eps_", ",", " ", "Gam0_", ",", " ", "TEM_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\n", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dim", ",", " ", "vals", ",", " ", "vecs", ",", " ", "lam", ",", " ", 
      "sm", ",", " ", "sp", ",", " ", "O1", ",", " ", "O2", ",", " ", "O3", 
      ",", " ", "O4", ",", "diss"}], "}"}], ",", "\n", "\n", 
    RowBox[{"(*", 
     RowBox[{"Dimension", " ", "of", " ", "the", " ", "space"}], "*)"}], "\n", 
    RowBox[{
     RowBox[{"dim", " ", "=", " ", 
      FractionBox[
       RowBox[{"Length", "@", "Ham"}], "2"]}], ";", "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{
      "Find", " ", "eigenvalues", " ", "and", " ", "eigenvectors", " ", "of", 
       " ", "Hamiltonian"}], "*)"}], "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vals", ",", " ", "vecs"}], "}"}], " ", "=", " ", 
      RowBox[{"Eigensystem", "@", "Ham"}]}], ";", "\n", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Construct", " ", "Eigenvalue", " ", "difference", " ", "array"}], 
      "*)"}], " ", "\n", 
     RowBox[{"lam", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ii", "-", "jj"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "vals"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"jj", ",", "vals"}], "}"}]}], "]"}]}], ";", "\n", "\n", 
     RowBox[{"sp", " ", "=", " ", 
      RowBox[{"tensor", "[", 
       RowBox[{
        RowBox[{"create", "[", "2", "]"}], ",", " ", 
        RowBox[{"qeye", "[", "dim", "]"}]}], "]"}]}], ";", "\n", 
     RowBox[{"sm", " ", "=", " ", 
      RowBox[{"tensor", "[", 
       RowBox[{
        RowBox[{"destroy", "[", "2", "]"}], ",", " ", 
        RowBox[{"qeye", "[", "dim", "]"}]}], "]"}]}], ";", "\n", "\n", 
     RowBox[{"O1", " ", "=", " ", 
      RowBox[{"Sum", "[", "\n", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"lam", "\[LeftDoubleBracket]", 
             RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}], "\[Equal]",
             "0"}], ",", " ", "0", ",", "\n", 
           RowBox[{
            RowBox[{"HeavisideTheta", "[", 
             RowBox[{"lam", "\[LeftDoubleBracket]", 
              RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}], "]"}], 
            "\[Times]", "\[Pi]", "\[Times]", 
            RowBox[{"JEM", "[", 
             RowBox[{
              RowBox[{"Abs", "@", 
               RowBox[{"lam", "\[LeftDoubleBracket]", 
                RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}]}], ",", 
              " ", "eps", ",", " ", "Gam0"}], "]"}], 
            RowBox[{"nocc", "[", 
             RowBox[{
              RowBox[{"Abs", "@", 
               RowBox[{"lam", "\[LeftDoubleBracket]", 
                RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}]}], ",", 
              " ", 
              RowBox[{"1", "/", "TEM"}]}], "]"}]}]}], "]"}], "\n", "\[Times]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{
            "vecs", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            "]"}], ".", "sp", ".", 
           RowBox[{
           "vecs", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}], 
          ")"}], "\[Times]", 
         RowBox[{"out", "[", 
          RowBox[{
           RowBox[{
           "vecs", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
           ",", " ", 
           RowBox[{
           "vecs", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}], 
          "]"}]}], ",", " ", "\n", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "@", "vals"}]}], "}"}], ",", " ", "\n", 
        RowBox[{"{", 
         RowBox[{"jj", ",", "1", ",", 
          RowBox[{"Length", "@", "vals"}]}], "}"}]}], "\n", "]"}]}], ";", 
     "\n", "\n", "\n", 
     RowBox[{"O2", " ", "=", " ", 
      RowBox[{"Sum", "[", "\n", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"lam", "\[LeftDoubleBracket]", 
             RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}], "\[Equal]",
             "0"}], ",", " ", "0", ",", "\n", 
           RowBox[{
            RowBox[{"HeavisideTheta", "[", 
             RowBox[{"lam", "\[LeftDoubleBracket]", 
              RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}], "]"}], 
            "\[Times]", "\[Pi]", "\[Times]", 
            RowBox[{"JEM", "[", 
             RowBox[{
              RowBox[{"Abs", "@", 
               RowBox[{"lam", "\[LeftDoubleBracket]", 
                RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}]}], ",", 
              " ", "eps", ",", " ", "Gam0"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"nocc", "[", 
               RowBox[{
                RowBox[{"Abs", "@", 
                 RowBox[{"lam", "\[LeftDoubleBracket]", 
                  RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}]}], ",",
                 " ", 
                RowBox[{"1", "/", "TEM"}]}], "]"}], " ", "+", " ", "1"}], 
             ")"}]}]}], "]"}], "\n", "\[Times]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{
            "vecs", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            "]"}], ".", "sp", ".", 
           RowBox[{
           "vecs", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}], 
          ")"}], "\[Times]", 
         RowBox[{"out", "[", 
          RowBox[{
           RowBox[{
           "vecs", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
           ",", " ", 
           RowBox[{
           "vecs", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}], 
          "]"}]}], ",", " ", "\n", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "@", "vals"}]}], "}"}], ",", " ", "\n", 
        RowBox[{"{", 
         RowBox[{"jj", ",", "1", ",", 
          RowBox[{"Length", "@", "vals"}]}], "}"}]}], "\n", "]"}]}], ";", 
     "\n", "\n", "\n", 
     RowBox[{"O3", " ", "=", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"lam", "\[LeftDoubleBracket]", 
             RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}], "\[Equal]",
             "0"}], ",", " ", "0", ",", "\n", 
           RowBox[{
            RowBox[{"HeavisideTheta", "[", 
             RowBox[{"-", 
              RowBox[{"lam", "\[LeftDoubleBracket]", 
               RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}]}], "]"}], 
            "\[Times]", "\[Pi]", "\[Times]", 
            RowBox[{"JEM", "[", 
             RowBox[{
              RowBox[{"Abs", "@", 
               RowBox[{"lam", "\[LeftDoubleBracket]", 
                RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}]}], ",", 
              " ", "eps", ",", " ", "Gam0"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"nocc", "[", 
               RowBox[{
                RowBox[{"Abs", "@", 
                 RowBox[{"lam", "\[LeftDoubleBracket]", 
                  RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}]}], ",",
                 " ", 
                RowBox[{"1", "/", "TEM"}]}], "]"}], " ", "+", " ", "1"}], 
             ")"}]}]}], "]"}], "\n", "\[Times]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{
            "vecs", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            "]"}], ".", "sm", ".", 
           RowBox[{
           "vecs", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}], 
          ")"}], "\[Times]", 
         RowBox[{"out", "[", 
          RowBox[{
           RowBox[{
           "vecs", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
           ",", " ", 
           RowBox[{
           "vecs", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}], 
          "]"}]}], ",", " ", "\n", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "@", "vals"}]}], "}"}], ",", " ", "\n", 
        RowBox[{"{", 
         RowBox[{"jj", ",", "1", ",", 
          RowBox[{"Length", "@", "vals"}]}], "}"}]}], "\n", "]"}]}], ";", 
     "\n", "\n", "\n", 
     RowBox[{"O4", " ", "=", " ", 
      RowBox[{"Sum", "[", "\n", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"lam", "\[LeftDoubleBracket]", 
             RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}], "\[Equal]",
             "0"}], ",", " ", "0", ",", "\n", 
           RowBox[{
            RowBox[{"HeavisideTheta", "[", 
             RowBox[{"-", 
              RowBox[{"lam", "\[LeftDoubleBracket]", 
               RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}]}], "]"}], 
            "\[Times]", "\[Pi]", "\[Times]", 
            RowBox[{"JEM", "[", 
             RowBox[{
              RowBox[{"Abs", "@", 
               RowBox[{"lam", "\[LeftDoubleBracket]", 
                RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}]}], ",", 
              " ", "eps", ",", " ", "Gam0"}], "]"}], 
            RowBox[{"nocc", "[", 
             RowBox[{
              RowBox[{"Abs", "@", 
               RowBox[{"lam", "\[LeftDoubleBracket]", 
                RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}]}], ",", 
              " ", 
              RowBox[{"1", "/", "TEM"}]}], "]"}]}]}], "]"}], "\n", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{
            "vecs", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            "]"}], ".", "sm", ".", 
           RowBox[{
           "vecs", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}], 
          ")"}], "\[Times]", 
         RowBox[{"out", "[", 
          RowBox[{
           RowBox[{
           "vecs", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
           ",", " ", 
           RowBox[{
           "vecs", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}], 
          "]"}]}], ",", " ", "\n", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "@", "vals"}]}], "}"}], ",", " ", "\n", 
        RowBox[{"{", 
         RowBox[{"jj", ",", "1", ",", 
          RowBox[{"Length", "@", "vals"}]}], "}"}]}], "\n", "]"}]}], ";", 
     "\n", "\n", 
     RowBox[{"diss", " ", "=", " ", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", "[", 
          RowBox[{"sm", ",", " ", 
           RowBox[{"O1", ".", 
            RowBox[{"Rho", "[", 
             RowBox[{"2", "dim"}], "]"}]}]}], "]"}], " ", "+", 
         RowBox[{"c", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Rho", "[", 
             RowBox[{"2", "dim"}], "]"}], ".", "O2"}], ",", " ", "sm"}], 
          "]"}], " ", "+", 
         RowBox[{"c", "[", 
          RowBox[{"sp", ",", " ", 
           RowBox[{"O3", ".", 
            RowBox[{"Rho", "[", 
             RowBox[{"2", "dim"}], "]"}]}]}], "]"}], " ", "+", " ", 
         RowBox[{"c", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Rho", "[", 
             RowBox[{"2", "dim"}], "]"}], ".", "O4"}], ",", " ", "sp"}], 
          "]"}]}], ")"}]}]}], ";", "\n", 
     RowBox[{"diss", " ", "=", " ", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", "[", 
          RowBox[{"sm", ",", " ", 
           RowBox[{"O1", ".", 
            RowBox[{"Rho", "[", 
             RowBox[{"2", "dim"}], "]"}]}]}], "]"}], " ", "+", 
         RowBox[{"c", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Rho", "[", 
             RowBox[{"2", "dim"}], "]"}], ".", "O2"}], ",", " ", "sm"}], 
          "]"}], " ", "+", 
         RowBox[{"c", "[", 
          RowBox[{"sp", ",", " ", 
           RowBox[{"O3", ".", 
            RowBox[{"Rho", "[", 
             RowBox[{"2", "dim"}], "]"}]}]}], "]"}], " ", "+", " ", 
         RowBox[{"c", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Rho", "[", 
             RowBox[{"2", "dim"}], "]"}], ".", "O4"}], ",", " ", "sp"}], 
          "]"}]}], ")"}]}]}], ";", "\n", "\n", "diss"}]}], "\n", 
   "]"}]}]}], "Code",
 CellChangeTimes->{{3.742793339500388*^9, 3.742793352046199*^9}, {
   3.742793390723832*^9, 3.7427940444509373`*^9}, 3.74279409090823*^9, {
   3.742795539469716*^9, 3.7427955398027763`*^9}, {3.742796356591425*^9, 
   3.742796360429755*^9}, {3.742796396856831*^9, 3.742796462369028*^9}, {
   3.752238716388088*^9, 3.752238725153192*^9}, {3.752238823544819*^9, 
   3.752238861886623*^9}, {3.7522388929177217`*^9, 3.752239031823297*^9}, 
   3.776403722270954*^9, {3.776499215101416*^9, 3.776499351906925*^9}, {
   3.7764993854796352`*^9, 3.776499387412768*^9}, {3.7764996113864317`*^9, 
   3.776499632918295*^9}, {3.776516436379138*^9, 3.7765164373134117`*^9}},
 ExpressionUUID -> "5e874534-c825-42ba-b19e-23fd99f1c8ae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UnderParameters", "[", 
    RowBox[{"alp_", ",", " ", "w0_", ",", " ", "Gam_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"(*", 
     RowBox[{"\[CapitalOmega]", " ", "="}], " ", "*)"}], " ", 
    RowBox[{"w0", ",", " ", 
     RowBox[{"(*", 
      RowBox[{"eta", " ", "="}], " ", "*)"}], 
     RowBox[{"Sqrt", "[", 
      RowBox[{
      "0.5", "\[Times]", "\[Pi]", "\[Times]", "alp", "\[Times]", "w0"}], 
      "]"}], ",", " ", 
     RowBox[{"(*", "gamma", "*)"}], " ", 
     RowBox[{"N", "[", 
      FractionBox["Gam", 
       RowBox[{"2", "\[Pi]", " ", "w0"}]], "]"}]}], "}"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"HUD", "[", 
   RowBox[{
   "dim_", ",", "eps_", ",", " ", "V_", ",", "alp_", ",", " ", "w0_", ",", 
    " ", "Gam_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "WRC", ",", " ", "eta", ",", " ", "gamma", ",", "sm", ",", " ", "sp", 
      ",", " ", "a", ",", " ", "adag", ",", "Ren", ",", " ", "H"}], "}"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"WRC", ",", " ", "eta", ",", " ", "gamma"}], "}"}], " ", "=", 
      " ", 
      RowBox[{"UnderParameters", "[", 
       RowBox[{"alp", ",", " ", "w0", ",", " ", "Gam"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Ren", " ", "=", " ", 
      RowBox[{
       SuperscriptBox["eta", "2"], "/", "WRC"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"H", " ", "=", " ", 
      RowBox[{
       RowBox[{"eps", " ", "\[Times]", " ", 
        RowBox[{"tensor", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"create", "[", "2", "]"}], ".", 
           RowBox[{"destroy", "[", "2", "]"}]}], ",", " ", 
          RowBox[{"qeye", "[", "dim", "]"}]}], "]"}]}], " ", "+", " ", 
       RowBox[{"V", "\[Times]", 
        RowBox[{"tensor", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"create", "[", "2", "]"}], " ", "+", " ", 
           RowBox[{"destroy", "[", "2", "]"}]}], ",", " ", 
          RowBox[{"qeye", "[", "dim", "]"}]}], "]"}]}]}]}], ";", " ", "\n", 
     RowBox[{"H", " ", "=", " ", 
      RowBox[{"H", " ", "+", " ", 
       RowBox[{"eta", "\[Times]", 
        RowBox[{"tensor", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"create", "[", "2", "]"}], ".", 
           RowBox[{"destroy", "[", "2", "]"}]}], ",", 
          RowBox[{
           RowBox[{"create", "[", "dim", "]"}], " ", "+", " ", 
           RowBox[{"destroy", "[", "dim", "]"}]}]}], "]"}]}]}]}], ";", "\n", 
     RowBox[{"H", " ", "=", " ", 
      RowBox[{"H", " ", "+", " ", 
       RowBox[{"WRC", " ", "\[Times]", 
        RowBox[{"tensor", "[", 
         RowBox[{
          RowBox[{"qeye", "[", "2", "]"}], ",", 
          RowBox[{
           RowBox[{"create", "[", "dim", "]"}], ".", 
           RowBox[{"destroy", "[", "dim", "]"}]}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "H"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ZetaRateFunc", "[", 
   RowBox[{"w_", ",", " ", "mu_", ",", " ", "beta_"}], "]"}], ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "w", "]"}], ">", "0"}], ",", " ", 
    RowBox[{
    "0.5", " ", "\[Times]", " ", "\[Pi]", " ", "mu", " ", "\[Times]", " ", 
     "w", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Coth", "[", 
        RowBox[{
        "0.5", " ", "\[Times]", " ", "beta", " ", "\[Times]", " ", "w"}], 
        "]"}], "+", "1"}], ")"}]}], ",", " ", 
    FractionBox[
     RowBox[{"\[Pi]", " ", "mu"}], "beta"]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ZetaRateFunc", ",", "Listable"}], "]"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ChiRateFunc", "[", 
     RowBox[{"w_", ",", " ", "mu_", ",", " ", "beta_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "w", "]"}], ">", "0"}], ",", " ", 
        RowBox[{
        "0.5", " ", "\[Times]", " ", "\[Pi]", " ", "mu", " ", "\[Times]", " ",
          "w", " ", 
         RowBox[{"Coth", "[", 
          RowBox[{
          "0.5", " ", "\[Times]", " ", "beta", " ", "\[Times]", " ", "w"}], 
          "]"}]}], ",", " ", 
        FractionBox[
         RowBox[{"\[Pi]", " ", "mu"}], "beta"]}], "]"}], "\n", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"ChiRateFunc", ",", "Listable"}], "]"}], "\[IndentingNewLine]",
       "\n", 
      RowBox[{"XiRateFunc", "[", 
       RowBox[{"w_", ",", " ", "mu_"}], "]"}]}], ":=", 
     RowBox[{
     "0.5", "\[Times]", "\[Pi]", "\[Times]", "mu", "\[Times]", "w", "\n", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"XiRateFunc", ",", "Listable"}], "]"}]}]}]}], "\n", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RateOps", "[", 
    RowBox[{"Ham_", ",", " ", "CoupOp_", ",", " ", "mu_", ",", " ", "beta_"}],
     "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vals", ",", " ", "vecs", ",", " ", "lam", ",", " ", "EigOp", ",", " ", 
       "st", ",", " ", "en", ",", " ", "ZetaRateArray", ",", "ZetaLab"}], 
      "}"}], ",", "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{
      "Find", " ", "eigenvalues", " ", "and", " ", "eigenvectors", " ", "of", 
       " ", "Hamiltonian"}], "*)"}], "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vals", ",", " ", "vecs"}], "}"}], " ", "=", " ", 
       RowBox[{"Eigensystem", "@", "Ham"}]}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "Construct", " ", "Eigenvalue", " ", "difference", " ", "array"}], 
       "*)"}], " ", "\[IndentingNewLine]", 
      RowBox[{"lam", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ii", "-", "jj"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "vals"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "vals"}], "}"}]}], "]"}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Find", " ", "the", " ", "array", " ", "of", " ", "overlaps", " ", 
        RowBox[{"(", 
         RowBox[{
         "the", " ", "coupling", " ", "operator", " ", "in", " ", "the", " ", 
          "eigenbasis"}]}]}], "*)"}], "\n", 
      RowBox[{"EigOp", " ", "=", " ", 
       RowBox[{"vecs", ".", "CoupOp", ".", 
        RowBox[{"Inverse", "[", "vecs", "]"}]}]}], ";", "\n", 
      RowBox[{"ZetaRateArray", " ", "=", " ", 
       RowBox[{"ZetaRateFunc", "[", 
        RowBox[{"lam", ",", " ", "mu", ",", " ", "beta"}], "]"}]}], ";", "\n",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Construct", " ", "the", " ", "rate", " ", "operator"}], 
       "*)"}], "\n", 
      RowBox[{"st", " ", "=", " ", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\n", 
      RowBox[{"ZetaLab", " ", "=", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ZetaRateArray", "\[LeftDoubleBracket]", 
           RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}], " ", 
          "\[Times]", " ", 
          RowBox[{"EigOp", "\[LeftDoubleBracket]", 
           RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}], "\[Times]", 
          RowBox[{"out", "[", 
           RowBox[{
            RowBox[{
            "vecs", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            ",", " ", 
            RowBox[{
            "vecs", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}],
            "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", 
           RowBox[{"Length", "@", "vals"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", 
           RowBox[{"Length", "@", "vals"}]}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"en", " ", "=", " ", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"print", "[", 
         RowBox[{"\"\<It took me \>\"", ",", " ", 
          RowBox[{"N", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"en", "-", "st"}], "60"], ",", " ", "3"}], "]"}], ",", 
          "\"\< minutes to construct the rate operators.\>\""}], "]"}], ";"}],
        "*)"}], "\n", 
      RowBox[{"{", "ZetaLab", "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RWAMeqLabNonAddInc", "[", 
    RowBox[{
    "dim_", ",", " ", "eps_", ",", " ", "V_", ",", " ", "alp_", ",", "w0_", 
     ",", "Gam_", ",", " ", "beta_", ",", " ", "Gam0_", ",", " ", "TEM_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\n", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "sm", ",", " ", "sp", ",", " ", "a", ",", " ", "adag", ",", " ", "WRC", 
       ",", " ", "eta", ",", " ", "gamma", ",", " ", "H", ",", " ", "rho", 
       ",", " ", "ZetaL", ",", " ", "CoupOp", ",", " ", "Xop", ",", " ", 
       "PhonDiss", ",", " ", "PhotDiss", ",", " ", "meq"}], "}"}], ",", "\n", 
     "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sm", ",", " ", "sp", ",", " ", "a", ",", " ", "adag"}], 
        "}"}], " ", "=", " ", 
       RowBox[{"ops", "[", "dim", "]"}]}], ";", "\n", "\n", 
      RowBox[{"(*", "Parameters", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"WRC", ",", " ", "eta", ",", " ", "gamma"}], "}"}], " ", "=", 
       " ", 
       RowBox[{"UnderParameters", "[", 
        RowBox[{"alp", ",", " ", "w0", ",", " ", "Gam"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{"Construct", " ", "Hamiltonian"}], "*)"}], "\n", 
      RowBox[{"H", " ", "=", " ", 
       RowBox[{"HUD", "[", 
        RowBox[{
        "dim", ",", "eps", ",", " ", "V", ",", "alp", ",", " ", "w0", ",", 
         " ", "Gam"}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{"Call", " ", "density", " ", "operator"}], "*)"}], "\n", 
      RowBox[{"rho", " ", "=", " ", 
       RowBox[{"Rho", "[", 
        RowBox[{"2", "\[Times]", "dim"}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "Construct", " ", "the", " ", "rate", " ", "operators", " ", "for", 
        " ", "phonons"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"{", "ZetaL", "}"}], " ", "=", " ", 
       RowBox[{"RateOps", "[", 
        RowBox[{"H", ",", " ", 
         RowBox[{"a", " ", "+", " ", "adag"}], ",", " ", "gamma", ",", " ", 
         "beta"}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{"Phonon", " ", "dissipator"}], "*)"}], " ", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"PhonDiss", " ", "=", " ", 
         RowBox[{
          RowBox[{"-", " ", 
           RowBox[{"c", "[", 
            RowBox[{
             RowBox[{"a", " ", "+", " ", "adag"}], ",", 
             RowBox[{"c", "[", 
              RowBox[{"ChiL", ",", " ", "rho"}], "]"}]}], "]"}]}], " ", "+", 
          " ", 
          RowBox[{"c", "[", 
           RowBox[{
            RowBox[{"a", " ", "+", " ", "adag"}], ",", " ", 
            RowBox[{"ac", "[", 
             RowBox[{"XiL", ",", " ", "rho"}], "]"}]}], "]"}]}]}], ";"}], 
       "*)"}], "\n", 
      RowBox[{"PhonDiss", " ", "=", " ", 
       RowBox[{
        RowBox[{"c", "[", 
         RowBox[{
          RowBox[{"a", " ", "+", " ", "adag"}], ",", " ", 
          RowBox[{"rho", ".", "ZetaL"}]}], "]"}], " ", "+", " ", 
        RowBox[{"c", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dag", "[", "ZetaL", "]"}], ".", "rho"}], ",", " ", 
          RowBox[{"a", " ", "+", " ", "adag"}]}], "]"}]}]}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{"Photonic", " ", "dissiaptor"}], "*)"}], "\n", 
      RowBox[{"PhotDiss", " ", "=", " ", 
       RowBox[{"PhotDissInc", "[", 
        RowBox[{"H", ",", " ", "eps", ",", " ", "Gam0", ",", " ", "TEM"}], 
        "]"}]}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{"build", " ", "the", " ", "master", " ", "equation"}], "*)"}], 
      "\n", 
      RowBox[{"meq", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"-", " ", "\[ImaginaryI]"}], " ", "\[Times]", " ", 
         RowBox[{"c", "[", 
          RowBox[{"H", ",", " ", "rho"}], "]"}]}], "  ", "+", " ", "PhonDiss",
         " ", "+", " ", "PhotDiss"}]}], ";", "\n", "\n", 
      RowBox[{"MeqToLio", "@", "meq"}]}]}], "]"}]}], " ", "\n"}], "\n", 
 RowBox[{
  RowBox[{"RCdynamicsNonAddInc", "[", 
   RowBox[{
   "dim_", ",", " ", "eps_", ",", "V_", ",", " ", "alp_", ",", " ", "w0_", 
    ",", " ", "Gam_", ",", " ", "beta_", ",", "Gam0_", ",", "TEM_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "inn", ",", " ", "innground", ",", " ", "lio", ",", " ", "rhoss", ",", 
      " ", "sol"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Build", " ", "Liouvillian"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lio", "=", " ", 
      RowBox[{"RWAMeqLabNonAddInc", "[", 
       RowBox[{
       "dim", ",", " ", "eps", ",", " ", "V", ",", " ", "alp", ",", " ", "w0",
         ",", " ", "Gam", ",", " ", "beta", ",", " ", "Gam0", ",", " ", 
        "TEM"}], "]"}]}], ";", "\[IndentingNewLine]", "\n", 
     RowBox[{"(*", 
      RowBox[{"Solve", " ", "steady", " ", "state"}], "*)"}], "\n", 
     RowBox[{"rhoss", " ", "=", " ", 
      RowBox[{"RhoSteady", "[", "lio", "]"}]}], ";", "\n", 
     "\[IndentingNewLine]", "rhoss"}]}], "]"}]}]}], "Code",
 CellChangeTimes->{{3.776499452705909*^9, 3.776499586177579*^9}, {
   3.7764996502888603`*^9, 3.776499659469345*^9}, {3.776513161557588*^9, 
   3.7765131656379623`*^9}, {3.776513235631229*^9, 3.776513236189818*^9}, {
   3.776513515096757*^9, 3.776513774584592*^9}, {3.7765138602544737`*^9, 
   3.776513924809466*^9}, {3.776514107809616*^9, 3.7765142150511837`*^9}, {
   3.77651424805081*^9, 3.776514277224267*^9}, {3.776514308405457*^9, 
   3.776514311393921*^9}, {3.776514588024641*^9, 3.7765145907917*^9}, 
   3.77651482902318*^9, {3.776514929060914*^9, 3.776514941817577*^9}, {
   3.7765158340370283`*^9, 3.776515837010367*^9}, {3.776515895145514*^9, 
   3.776515899717894*^9}, {3.776516047629249*^9, 3.776516049644457*^9}, {
   3.776516123167715*^9, 3.776516123742289*^9}},
 ExpressionUUID -> "dc18fa29-47e6-46ec-9e09-48be11647ad7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"T1ps", " ", "=", " ", "100"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"eVtoinvcm", " ", "=", " ", "8065.5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cmtops", " ", "=", " ", 
   RowBox[{"1", "/", "0.188"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eps", " ", "=", " ", 
   RowBox[{"2", " ", "*", " ", "eVtoinvcm"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hbareVps", " ", "=", 
   RowBox[{"6.582", " ", "*", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "4"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gam0eV", " ", "=", " ", 
   RowBox[{"hbareVps", " ", "/", "T1ps"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gam0", " ", "=", " ", 
   RowBox[{"Gam0eV", "*", "eVtoinvcm"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w0", " ", "=", " ", "400"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gam", "=", "80"}], 
  RowBox[{"(*", 
   RowBox[{"0.01", "eps"}], "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kb", " ", "=", " ", "0.695"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "  ", "=", " ", 
   RowBox[{"300", "\[Times]", "kb"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beta", " ", "=", " ", 
   RowBox[{"1", "/", "T"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TEM", " ", "=", " ", 
   RowBox[{"6000", "\[Times]", "kb"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alprange", " ", "=", " ", 
   RowBox[{
    RowBox[{"linspace", "[", 
     RowBox[{"0.0001", ",", "0.8", ",", "10"}], "]"}], "eps"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7759934207489567`*^9, 3.775993425948557*^9}, 
   3.776401914229698*^9},
 ExpressionUUID -> "4c791cdf-8e74-4ec0-a4f4-895299e813e2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dim", " ", "=", "15"}]], "Input",
 CellChangeTimes->{
  3.776499411518467*^9, 3.7764995166944933`*^9, {3.7764996849369297`*^9, 
   3.776499696344446*^9}},
 ExpressionUUID -> "4f340292-85b8-4290-bcb5-9d1c644acf23"],

Cell[BoxData["15"], "Output",
 CellChangeTimes->{{3.776499693466833*^9, 3.776499696742304*^9}, 
   3.7765129335126057`*^9, 3.7765137841256123`*^9, 3.776514366196517*^9, 
   3.776514433030699*^9, {3.776514598835045*^9, 3.7765146172461157`*^9}, 
   3.776515356770904*^9, 3.776515956984385*^9, 3.776516059563249*^9, 
   3.776516126541877*^9},
 ExpressionUUID -> "941585eb-2f0f-404e-b7f1-b156bc337b80"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NonAddDat", " ", "=", 
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      FractionBox["alp", "eps"], ",", 
      RowBox[{"Chop", "@", 
       RowBox[{"Tr", "[", 
        RowBox[{
         RowBox[{"tensor", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"create", "[", "2", "]"}], ".", 
            RowBox[{"destroy", "[", "2", "]"}]}], ",", 
           RowBox[{"qeye", "[", "dim", "]"}]}], "]"}], ".", 
         RowBox[{"RCdynamicsNonAddInc", "[", 
          RowBox[{
          "dim", ",", " ", "eps", ",", "0", ",", " ", "alp", ",", " ", "w0", 
           ",", " ", "Gam", ",", " ", "beta", ",", "Gam0", ",", "TEM"}], 
          "]"}]}], "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"alp", ",", "alprange"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.776499564329248*^9, 3.77649956447114*^9}, {
  3.7765153894747763`*^9, 3.776515390108924*^9}},
 ExpressionUUID -> "02a2a306-ef2f-4551-8238-7e0e0ac06666"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.0001`", ",", "0.020483321121503157`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.08009000000000001`", ",", "0.04453945870451419`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.16008000000000003`", ",", "0.09734769391019955`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.24007000000000003`", ",", 
     RowBox[{"0.18324567621317409`", "\[VeryThinSpace]", "-", 
      RowBox[{"1.8303627249190256`*^-10", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.32006`", ",", 
     RowBox[{"0.31399627448981476`", "\[VeryThinSpace]", "+", 
      RowBox[{"3.0734245438423793`*^-10", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.40005`", ",", 
     RowBox[{"0.4983040861793629`", "\[VeryThinSpace]", "-", 
      RowBox[{"6.799090225270963`*^-10", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.48004`", ",", 
     RowBox[{"0.7142843468768765`", "\[VeryThinSpace]", "+", 
      RowBox[{"5.963236715042278`*^-10", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.5600300000000001`", ",", 
     RowBox[{"0.8938977813187156`", "\[VeryThinSpace]", "+", 
      RowBox[{"1.460553678731563`*^-9", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.6400200000000001`", ",", 
     RowBox[{"0.9787013491110566`", "\[VeryThinSpace]", "+", 
      RowBox[{"2.292372999552461`*^-9", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.7200100000000001`", ",", 
     RowBox[{"0.9978761064524447`", "\[VeryThinSpace]", "+", 
      RowBox[{"2.6034344402524306`*^-9", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.8000000000000002`", ",", 
     RowBox[{"0.9999003854968488`", "\[VeryThinSpace]", "+", 
      RowBox[{"8.320091459086956`*^-9", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7765160262195177`*^9, 3.776516102540202*^9, 
  3.776516174383169*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Re", "@", "NonAddDat"}], "]"}]], "Input",
 CellChangeTimes->{{3.776499668616797*^9, 3.776499674967567*^9}, {
  3.776499730184243*^9, 3.776499732028102*^9}},
 ExpressionUUID -> "0ae220cb-7a2e-4873-9328-85282d24ca8e"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], 
     PointBox[{{0.0001, 0.020483321121503157`}, {0.08009000000000001, 
      0.04453945870451419}, {0.16008000000000003`, 0.09734769391019955}, {
      0.24007000000000003`, 0.18324567621317409`}, {0.32006, 
      0.31399627448981476`}, {0.40005, 0.4983040861793629}, {0.48004, 
      0.7142843468768765}, {0.5600300000000001, 0.8938977813187156}, {
      0.6400200000000001, 0.9787013491110566}, {0.7200100000000001, 
      0.9978761064524447}, {0.8000000000000002, 
      0.9999003854968488}}]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0, 0.8000000000000002}, {0, 0.9999003854968488}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.7764996754126043`*^9, 3.776499689742237*^9}, {
   3.776499722705311*^9, 3.776499732522224*^9}, 3.7765130469441767`*^9, 
   3.776513836585659*^9, 3.7765161087957973`*^9, 3.7765161785879517`*^9},
 ExpressionUUID -> "bb40157e-84de-40a8-be3c-ce177b5fc38e"]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{296, Automatic}, {Automatic, 50}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 15472, 433, 1360, "Code"],
Cell[16033, 455, 13441, 335, 979, "Code"],
Cell[29477, 792, 14376, 355, 1361, "Code"],
Cell[43856, 1149, 1773, 49, 252, "Input"],
Cell[CellGroupData[{
Cell[45654, 1202, 237, 5, 28, "Input"],
Cell[45894, 1209, 398, 6, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46329, 1220, 996, 25, 51, "Input"],
Cell[47328, 1247, 2039, 50, 79, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49404, 1302, 267, 5, 28, "Input"],
Cell[49674, 1309, 1581, 35, 244, "Output"]
}, Open  ]]
}
]
*)

